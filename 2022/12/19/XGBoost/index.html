

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/logo.svg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Xander Xu">
  <meta name="keywords" content="">
  
    <meta name="description" content="深入剖析XGBoost算法的核心原理、技术创新及其在数据科学中的应用价值，从基础概念到高级优化，全面解读这一强大机器学习工具的本质。">
<meta property="og:type" content="article">
<meta property="og:title" content="XGBoost">
<meta property="og:url" content="http://xcq.ink/2022/12/19/XGBoost/index.html">
<meta property="og:site_name" content="人菜瘾大的小强">
<meta property="og:description" content="深入剖析XGBoost算法的核心原理、技术创新及其在数据科学中的应用价值，从基础概念到高级优化，全面解读这一强大机器学习工具的本质。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-12-19T13:13:49.000Z">
<meta property="article:modified_time" content="2025-03-10T00:47:28.782Z">
<meta property="article:author" content="Xander Xu">
<meta property="article:tag" content="XGBoost">
<meta property="article:tag" content="决策树">
<meta property="article:tag" content="集成学习">
<meta property="article:tag" content="梯度提升">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>XGBoost - 人菜瘾大的小强</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xcq.ink","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":"ac2559fe71d82eda0e6372616e40089e","google":"G-L228BYNZ7T","tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>人菜瘾大的小强</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="XGBoost"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-12-19 21:13" pubdate>
          2022年12月19日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          34 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">XGBoost</h1>
            
            
              <div class="markdown-body">
                
                <p>在机器学习的众多算法中，XGBoost以其卓越的性能和广泛的适用性成为了数据科学家的必备工具。无论是Kaggle竞赛还是工业级应用，XGBoost常常是模型选择的首选。但它为何如此强大？本文将从本质出发，层层深入，揭示XGBoost的核心机制及其成功背后的数学原理。</p>
<h2 id="1-决策树xgboost的基础构件"><a class="markdownIt-Anchor" href="#1-决策树xgboost的基础构件"></a> 1. 决策树：XGBoost的基础构件</h2>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 840 520" style="background-color: #ffffff;">
  <defs>
    <!-- 渐变定义 -->
    <linearGradient id="blueGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#4F6DB8" />
      <stop offset="100%" stop-color="#3F56A0" />
    </linearGradient>
    <linearGradient id="redGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#E05D5D" />
      <stop offset="100%" stop-color="#C64545" />
    </linearGradient>
    <linearGradient id="nodeGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#7E57C2" />
      <stop offset="100%" stop-color="#673AB7" />
    </linearGradient>
    <!-- 滤镜 -->
    <filter id="shadowEffect" height="130%">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-opacity="0.3"/>
    </filter>
    <!-- 动画路径 -->
    <path id="pathLeft" d="M400,140 Q300,200 250,260" fill="none" stroke="none"/>
    <path id="pathRight" d="M400,140 Q500,200 550,260" fill="none" stroke="none"/>
  </defs>
  <!-- 标题 -->
  <text x="400" y="50" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">决策树：如何划分数据</text>
  <!-- 树结构和空间划分的容器 -->
  <g transform="translate(0, 80)">
    <!-- 左侧：决策树结构 -->
    <g transform="translate(50, 0)">
      <text x="150" y="0" text-anchor="middle" font-size="17" font-weight="bold" fill="#333">决策树结构</text>
      <!-- 根节点 -->
      <g>
        <circle cx="150" cy="60" r="30" fill="url(#nodeGradient)" filter="url(#shadowEffect)"/>
        <text x="150" y="58" text-anchor="middle" font-size="12" fill="white">X₁ ≤ 0.5</text>
        <text x="150" y="75" text-anchor="middle" font-size="12" fill="white">根节点</text>
        <!-- 动画：根节点的脉动效果 -->
        <animate 
          xlink:href="circle" 
          attributeName="r" 
          values="30;32;30" 
          dur="2s" 
          repeatCount="indefinite"/>
      </g>
      <!-- 左子树连线 -->
      <path d="M150,90 C150,120 100,150 80,180" fill="none" stroke="#673AB7" stroke-width="3"/>
      <!-- 左子节点 -->
      <g>
        <circle cx="80" cy="180" r="25" fill="url(#nodeGradient)" filter="url(#shadowEffect)"/>
        <text x="80" y="178" text-anchor="middle" font-size="11" fill="white">X₂ ≤ 0.3</text>
        <text x="80" y="193" text-anchor="middle" font-size="10" fill="white">内部节点</text>
      </g>
      <!-- 左子树叶节点连线 -->
      <path d="M80,205 C80,235 50,255 40,275" fill="none" stroke="#673AB7" stroke-width="2"/>
      <path d="M80,205 C80,235 110,255 120,275" fill="none" stroke="#673AB7" stroke-width="2"/>
      <!-- 左子树叶节点 -->
      <g>
        <rect x="25" y="275" width="30" height="30" rx="5" fill="url(#blueGradient)" filter="url(#shadowEffect)"/>
        <text x="40" y="295" text-anchor="middle" font-size="12" fill="white">A类</text>
      </g>
      <g>
        <rect x="105" y="275" width="30" height="30" rx="5" fill="url(#redGradient)" filter="url(#shadowEffect)"/>
        <text x="120" y="295" text-anchor="middle" font-size="12" fill="white">B类</text>
      </g>
      <!-- 右子树连线 -->
      <path d="M150,90 C150,120 200,150 220,180" fill="none" stroke="#673AB7" stroke-width="3"/>
      <!-- 右子节点 -->
      <g>
        <circle cx="220" cy="180" r="25" fill="url(#nodeGradient)" filter="url(#shadowEffect)"/>
        <text x="220" y="178" text-anchor="middle" font-size="11" fill="white">X₃ ≤ 0.7</text>
        <text x="220" y="193" text-anchor="middle" font-size="10" fill="white">内部节点</text>
      </g>
      <!-- 右子树叶节点连线 -->
      <path d="M220,205 C220,235 190,255 180,275" fill="none" stroke="#673AB7" stroke-width="2"/>
      <path d="M220,205 C220,235 250,255 260,275" fill="none" stroke="#673AB7" stroke-width="2"/>
      <!-- 右子树叶节点 -->
      <g>
        <rect x="165" y="275" width="30" height="30" rx="5" fill="url(#blueGradient)" filter="url(#shadowEffect)"/>
        <text x="180" y="295" text-anchor="middle" font-size="12" fill="white">A类</text>
      </g>
      <g>
        <rect x="245" y="275" width="30" height="30" rx="5" fill="url(#redGradient)" filter="url(#shadowEffect)"/>
        <text x="260" y="295" text-anchor="middle" font-size="12" fill="white">B类</text>
      </g>
      <!-- 决策标签 -->
      <text x="102" y="125" text-anchor="middle" font-size="12" fill="#555">是 X₁≤0.5</text>
      <text x="198" y="125" text-anchor="middle" font-size="12" fill="#555">否 X₁>0.5</text>
      <text x="45" y="230" text-anchor="middle" font-size="12" fill="#555">是 X₂≤0.3</text>
      <text x="115" y="230" text-anchor="middle" font-size="12" fill="#555">否 X₂>0.3</text>
      <text x="185" y="230" text-anchor="middle" font-size="12" fill="#555">是 X₃≤0.7</text>
      <text x="257" y="230" text-anchor="middle" font-size="12" fill="#555">否 X₃>0.7</text>
    </g>
    <!-- 右侧：特征空间划分 -->
    <g transform="translate(400, 0)">
      <text x="150" y="0" text-anchor="middle" font-size="17" font-weight="bold" fill="#333">特征空间划分</text>
      <!-- 坐标网格 -->
      <rect x="0" y="40" width="300" height="300" fill="#f8f8f8" stroke="#ddd" stroke-width="1"/>
      <!-- 网格线 -->
      <line x1="0" y1="115" x2="300" y2="115" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
      <line x1="0" y1="190" x2="300" y2="190" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
      <line x1="0" y1="265" x2="300" y2="265" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
      <line x1="75" y1="40" x2="75" y2="340" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
      <line x1="150" y1="40" x2="150" y2="340" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
      <line x1="225" y1="40" x2="225" y2="340" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
      <!-- 坐标轴标注 -->
      <text x="-10" y="40" font-size="12" text-anchor="end" fill="#666">1.0</text>
      <text x="-10" y="115" font-size="12" text-anchor="end" fill="#666">0.75</text>
      <text x="-10" y="190" font-size="12" text-anchor="end" fill="#666">0.5</text>
      <text x="-10" y="265" font-size="12" text-anchor="end" fill="#666">0.25</text>
      <text x="-10" y="340" font-size="12" text-anchor="end" fill="#666">0.0</text>
      <text x="0" y="355" font-size="12" text-anchor="middle" fill="#666">0.0</text>
      <text x="75" y="355" font-size="12" text-anchor="middle" fill="#666">0.25</text>
      <text x="150" y="355" font-size="12" text-anchor="middle" fill="#666">0.5</text>
      <text x="225" y="355" font-size="12" text-anchor="middle" fill="#666">0.75</text>
      <text x="300" y="355" font-size="12" text-anchor="middle" fill="#666">1.0</text>
      <!-- 轴标签 -->
      <text x="150" y="375" font-size="14" text-anchor="middle" font-weight="bold" fill="#555">X₁</text>
      <text x="-35" y="190" font-size="14" text-anchor="middle" font-weight="bold" fill="#555" transform="rotate(-90, -30, 190)">X₂</text>
      <!-- 决策边界线 -->
      <line x1="150" y1="40" x2="150" y2="340" stroke="#673AB7" stroke-width="2.5">
        <!-- 动画：第一个决策边界出现 -->
        <animate attributeName="stroke-dashoffset" from="300" to="0" dur="2s" fill="freeze" begin="0s"/>
        <animate attributeName="stroke-dasharray" from="300,300" to="0,0" dur="2s" fill="freeze" begin="0s"/>
      </line>
      <text x="160" y="60" font-size="14" fill="#673AB7">X₁=0.5</text>
      <!-- 左右子区域中的次级划分 -->
      <line x1="0" y1="120" x2="150" y2="120" stroke="#673AB7" stroke-width="2">
        <!-- 动画：第二个决策边界出现 -->
        <animate attributeName="stroke-dashoffset" from="150" to="0" dur="1.5s" fill="freeze" begin="2s"/>
        <animate attributeName="stroke-dasharray" from="150,150" to="0,0" dur="1.5s" fill="freeze" begin="2s"/>
      </line>
      <text x="70" y="110" font-size="14" fill="#673AB7">X₂=0.3</text>
      <line x1="210" y1="40" x2="210" y2="340" stroke="#673AB7" stroke-width="2">
        <!-- 动画：第三个决策边界出现 -->
        <animate attributeName="stroke-dashoffset" from="300" to="0" dur="1.5s" fill="freeze" begin="2s"/>
        <animate attributeName="stroke-dasharray" from="300,300" to="0,0" dur="1.5s" fill="freeze" begin="2s"/>
      </line>
      <text x="220" y="60" font-size="14" fill="#673AB7">X₃=0.7</text>
      <!-- 区域标注 -->
      <text x="75" y="90" font-size="10" fill="#E05D5D" font-weight="bold">区域1: B类</text>
      <text x="75" y="220" font-size="10" fill="#4F6DB8" font-weight="bold">区域2: A类</text>
      <text x="153" y="140" font-size="10" fill="#4F6DB8" font-weight="bold">区域3: A类</text>
      <text x="230" y="170" font-size="10" fill="#E05D5D" font-weight="bold">区域4: B类</text>
      <!-- 示例数据点 - 区域1 -->
      <g id="region1" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="1s" fill="freeze" begin="3.5s"/>
        <circle cx="45" cy="60" r="5" fill="#E05D5D"/>
        <circle cx="65" cy="90" r="5" fill="#E05D5D"/>
        <circle cx="95" cy="75" r="5" fill="#E05D5D"/>
        <circle cx="120" cy="100" r="5" fill="#E05D5D"/>
        <circle cx="25" cy="80" r="5" fill="#E05D5D"/>
        <circle cx="110" cy="60" r="5" fill="#E05D5D"/>
      </g>
      <!-- 示例数据点 - 区域2 -->
      <g id="region2" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="1s" fill="freeze" begin="4s"/>
        <circle cx="30" cy="180" r="5" fill="#4F6DB8"/>
        <circle cx="70" cy="210" r="5" fill="#4F6DB8"/>
        <circle cx="100" cy="180" r="5" fill="#4F6DB8"/>
        <circle cx="120" cy="240" r="5" fill="#4F6DB8"/>
        <circle cx="50" cy="290" r="5" fill="#4F6DB8"/>
        <circle cx="90" cy="270" r="5" fill="#4F6DB8"/>
      </g>
      <!-- 示例数据点 - 区域3 -->
      <g id="region3" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="1s" fill="freeze" begin="4.5s"/>
        <circle cx="170" cy="90" r="5" fill="#4F6DB8"/>
        <circle cx="185" cy="150" r="5" fill="#4F6DB8"/>
        <circle cx="195" cy="210" r="5" fill="#4F6DB8"/>
        <circle cx="180" cy="270" r="5" fill="#4F6DB8"/>
        <circle cx="160" cy="180" r="5" fill="#4F6DB8"/>
      </g>
      <!-- 示例数据点 - 区域4 -->
      <g id="region4" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="1s" fill="freeze" begin="5s"/>
        <circle cx="240" cy="80" r="5" fill="#E05D5D"/>
        <circle cx="260" cy="130" r="5" fill="#E05D5D"/>
        <circle cx="270" cy="190" r="5" fill="#E05D5D"/>
        <circle cx="250" cy="250" r="5" fill="#E05D5D"/>
        <circle cx="230" cy="210" r="5" fill="#E05D5D"/>
      </g>
      <!-- 示范数据点 - 动画示例 -->
      <g>
        <circle id="samplePoint" cx="220" cy="100" r="7" fill="yellow" stroke="#333" stroke-width="1.5" opacity="0">
          <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="6s"/>
          <animate attributeName="cx" from="220" to="150" dur="1s" fill="freeze" begin="7s"/>
          <animate attributeName="cy" from="100" to="60" dur="1s" fill="freeze" begin="7s"/>
          <animate attributeName="fill" from="yellow" to="orange" dur="0.3s" fill="freeze" begin="8s"/>
          <animate attributeName="r" from="7" to="9" dur="0.3s" fill="freeze" begin="8s"/>
          <animate attributeName="r" from="9" to="7" dur="0.3s" fill="freeze" begin="8.3s"/>
          <animate attributeName="cx" from="150" to="220" dur="1s" fill="freeze" begin="9s"/>
          <animate attributeName="cy" from="60" to="180" dur="1s" fill="freeze" begin="9s"/>
          <animate attributeName="fill" from="orange" to="green" dur="0.3s" fill="freeze" begin="10s"/>
          <animate attributeName="r" from="7" to="9" dur="0.3s" fill="freeze" begin="10s"/>
          <animate attributeName="r" from="9" to="7" dur="0.3s" fill="freeze" begin="10.3s"/>
          <animate attributeName="cx" from="220" to="260" dur="1s" fill="freeze" begin="11s"/>
          <animate attributeName="cy" from="180" to="220" dur="1s" fill="freeze" begin="11s"/>
          <animate attributeName="fill" from="green" to="#E05D5D" dur="0.5s" fill="freeze" begin="12s"/>
        </circle>
        <!-- 跟踪文字 -->
        <text id="trackingText" x="220" y="85" font-size="12" text-anchor="middle" fill="#333" opacity="0">
          <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="6s"/>
          <animate attributeName="x" from="220" to="150" dur="1s" fill="freeze" begin="7s"/>
          <animate attributeName="y" from="85" to="45" dur="1s" fill="freeze" begin="7s"/>
          <animate attributeName="x" from="150" to="220" dur="1s" fill="freeze" begin="9s"/>
          <animate attributeName="y" from="45" to="165" dur="1s" fill="freeze" begin="9s"/>
          <animate attributeName="x" from="220" to="260" dur="1s" fill="freeze" begin="11s"/>
          <animate attributeName="y" from="165" to="205" dur="1s" fill="freeze" begin="11s"/>
        </text>
      </g>
    </g>
  </g>
  <!-- 底部说明 -->
  <g transform="translate(400, 450)">
    <rect x="-350" y="-5" width="700" height="50" rx="8" fill="#f5f0ff" stroke="#673AB7" stroke-width="1"/>
    <text x="0" y="15" text-anchor="middle" font-size="18" font-weight="bold" fill="#673AB7">决策树如何工作</text>
    <text x="0" y="35" text-anchor="middle" font-size="14" fill="#333">通过递归二分特征空间，决策树将复杂数据分割成可预测的区域</text>
  </g>
  <!-- 动画步骤说明 -->
  <g transform="translate(700, 100)" id="animationSteps">
    <text x="10" y="0" font-size="14" font-weight="bold" fill="#333" opacity="0">第一步：划分X₁
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="0.5s"/>
      <animate attributeName="opacity" from="1" to="0.3" dur="0.5s" fill="freeze" begin="2s"/>
    </text>
    <text x="10" y="25" font-size="14" font-weight="bold" fill="#333" opacity="0">第二步：子区域划分
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="2.5s"/>
      <animate attributeName="opacity" from="1" to="0.3" dur="0.5s" fill="freeze" begin="4s"/>
    </text>
    <text x="10" y="50" font-size="14" font-weight="bold" fill="#333" opacity="0">第三步：数据分类
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="4.5s"/>
      <animate attributeName="opacity" from="1" to="0.3" dur="0.5s" fill="freeze" begin="6s"/>
    </text>
    <text x="10" y="75" font-size="14" font-weight="bold" fill="#333" opacity="0">第四步：样本分类演示
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="6.5s"/>
    </text>
    <text x="10" y="100" font-size="12" fill="#555" opacity="0">黄点开始在X₁>0.5区域
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="7s"/>
      <animate attributeName="opacity" from="1" to="0.3" dur="0.5s" fill="freeze" begin="9s"/>
    </text>
    <text x="10" y="125" font-size="12" fill="#555" opacity="0">检查X₃条件
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="9.5s"/>
      <animate attributeName="opacity" from="1" to="0.3" dur="0.5s" fill="freeze" begin="11s"/>
    </text>
    <text x="10" y="150" font-size="12" fill="#555" opacity="0">最终分类：B类
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" fill="freeze" begin="12s"/>
    </text>
  </g>
</svg>
<p>决策树是一种直观的模型，通过一系列二元问题将数据空间划分为不同区域。它就像我们日常决策的过程：通过回答一系列是/否问题，最终得出结论。</p>
<h3 id="11-决策树的工作原理"><a class="markdownIt-Anchor" href="#11-决策树的工作原理"></a> 1.1 决策树的工作原理</h3>
<p>在数学上，决策树寻求在每个节点上找到最佳分割特征和阈值，使得分割后的子节点具有最高的&quot;纯度&quot;。这一过程通常使用信息增益、基尼不纯度或方差减少等指标来衡量：</p>
<p>对于分类问题，基尼不纯度的计算公式为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Gini</mtext><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msubsup><mi>p</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\text{Gini}(D) = 1 - \sum_{i=1}^{k} p_i^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Gini</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是类别<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>在节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>中的比例。</p>
<p>对于回归问题，常用均方差：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>MSE</mtext><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>D</mi></mrow></munder><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\text{MSE}(D) = \frac{1}{|D|}\sum_{i \in D}(y_i - \bar{y})^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">MSE</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.6431459999999998em;vertical-align:-1.321706em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="12-单棵决策树的局限性"><a class="markdownIt-Anchor" href="#12-单棵决策树的局限性"></a> 1.2 单棵决策树的局限性</h3>
<p>尽管概念简单，但单棵决策树存在明显缺陷：</p>
<ul>
<li><strong>高方差</strong>：对训练数据过度拟合，难以泛化</li>
<li><strong>结构不稳定</strong>：数据微小变化可能导致树结构剧变</li>
<li><strong>表达能力有限</strong>：难以捕捉复杂的非线性关系</li>
</ul>
<blockquote>
<p>想象一位医生仅通过一个问题（“体温是否超过38度？”）来诊断疾病。这显然过于简化，无法处理复杂的医疗诊断情况。单棵决策树的局限性也是如此。</p>
</blockquote>
<h2 id="2-集成方法从森林到梯度提升"><a class="markdownIt-Anchor" href="#2-集成方法从森林到梯度提升"></a> 2. 集成方法：从森林到梯度提升</h2>
<p>为了克服单棵决策树的局限，机器学习专家发明了集成方法。这些方法整合多棵树的预测，形成更强大、更稳定的模型。</p>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 600" style="background-color: #fcfcfc;">
  <defs>
    <!-- 渐变定义 -->
    <linearGradient id="mainGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#f5f7fa" />
      <stop offset="100%" stop-color="#f0f2f5" />
    </linearGradient>
    <linearGradient id="rfGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#66bb6a" />
      <stop offset="100%" stop-color="#43a047" />
    </linearGradient>
    <linearGradient id="gbGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#42a5f5" />
      <stop offset="100%" stop-color "#1e88e5" />
    </linearGradient>
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#2c3e50" />
      <stop offset="100%" stop-color="#2c3e50" stop-opacity="0.8" />
    </linearGradient>
    <linearGradient id="dataPlotGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#F8F9FA" />
      <stop offset="100%" stop-color="#f0f0f0" />
    </linearGradient>
    <!-- 滤镜定义 -->
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="2" />
      <feOffset dx="1" dy="1" result="offsetblur" />
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.15" />
      </feComponentTransfer>
      <feMerge>
        <feMergeNode />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <!-- 定义箭头标记 -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L0,7 L9,3.5 Z" fill="#555" />
    </marker>
    <!-- 定义类别1点的渐变（用于随机森林） -->
    <radialGradient id="class1RF" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="0%" stop-color="#c8e6c9" />
      <stop offset="100%" stop-color="#81c784" />
    </radialGradient>
    <!-- 定义类别2点的渐变（用于随机森林） -->
    <radialGradient id="class2RF" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="0%" stop-color="#ffccbc" />
      <stop offset="100%" stop-color="#ff8a65" />
    </radialGradient>
    <!-- 定义类别1点的渐变（用于梯度提升） -->
    <radialGradient id="class1GB" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="0%" stop-color="#bbdefb" />
      <stop offset="100%" stop-color="#64b5f6" />
    </radialGradient>
    <!-- 定义类别2点的渐变（用于梯度提升） -->
    <radialGradient id="class2GB" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="0%" stop-color="#ffccbc" />
      <stop offset="100%" stop-color="#ff8a65" />
    </radialGradient>
    <!-- 定义预测错误点的渐变 -->
    <radialGradient id="errorPoint" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
      <stop offset="0%" stop-color="#ffcdd2" />
      <stop offset="100%" stop-color="#e57373" />
    </radialGradient>
    <!-- 动画路径 -->
    <path id="tree1Path" d="M0,0 Q50,-30 100,-10" fill="none" />
    <path id="tree2Path" d="M0,0 Q50,20 100,10" fill="none" />
    <path id="tree3Path" d="M0,0 Q40,0 100,0" fill="none" />
  </defs>
  <!-- 背景 -->
  <rect width="960" height="600" fill="url(#mainGradient)" />
  <!-- 顶部标题栏 -->
  <rect x="0" y="0" width="960" height="60" fill="url(#headerGradient)" />
  <text x="480" y="38" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="24" font-weight="600" fill="white">集成学习方法对比：随机森林 vs 梯度提升</text>
  <!-- 中间分隔线 -->
  <line x1="480" y1="60" x2="480" y2="580" stroke="#ddd" stroke-width="1.5" stroke-dasharray="5,5" />
  <!-- 左侧标题：随机森林 -->
  <text x="240" y="90" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="20" font-weight="600" fill="#2e7d32">随机森林</text>
  <text x="240" y="115" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" fill="#555">并行训练多棵独立树，通过投票/平均组合结果</text>
  <!-- 右侧标题：梯度提升 -->
  <text x="720" y="90" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="20" font-weight="600" fill="#1565c0">梯度提升</text>
  <text x="720" y="115" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" fill="#555">按顺序训练树，每棵树专注修正前面的错误</text>
  <!-- 左侧：随机森林可视化 -->
  <g transform="translate(240, 300)">
    <!-- 数据空间背景 -->
    <rect x="-200" y="-150" width="400" height="300" rx="5" fill="url(#dataPlotGradient)" stroke="#ddd" stroke-width="1" filter="url(#dropShadow)" />
    <!-- 坐标轴 -->
    <line x1="-180" y1="130" x2="180" y2="130" stroke="#999" stroke-width="1" />
    <line x1="-180" y1="-130" x2="-180" y2="130" stroke="#999" stroke-width="1" />
    <text x="0" y="145" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#666">特征 1</text>
    <text x="-195" y="0" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#666" transform="rotate(-90, -195, 0)">特征 2</text>
    <!-- 数据点 - 静态部分 -->
    <g>
      <!-- 类别1数据点 -->
      <circle cx="-140" cy="-100" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-120" cy="-80" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-110" cy="-110" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-90" cy="-90" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-80" cy="-120" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-70" cy="-60" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-50" cy="-70" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="-30" cy="80" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="0" cy="90" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="20" cy="100" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="40" cy="70" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <circle cx="60" cy="110" r="6" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <!-- 类别2数据点 -->
      <circle cx="-30" cy="10" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="-10" cy="-10" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="10" cy="20" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="20" cy="-20" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="30" cy="0" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="40" cy="-30" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="50" cy="10" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="70" cy="-70" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="90" cy="-40" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="110" cy="-90" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="130" cy="-60" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <circle cx="150" cy="-100" r="6" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
    </g>
    <!-- 边界线 - 树1 (简单垂直线) -->
    <line id="tree1-boundary" x1="0" y1="-130" x2="0" y2="130" stroke="#43a047" stroke-width="2" stroke-opacity="0" stroke-dasharray="5,3">
      <animate attributeName="stroke-opacity" from="0" to="0.7" dur="1s" begin="0.5s" fill="freeze" />
    </line>
    <text x="0" y="-120" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#43a047" opacity="0">
      树1边界
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="1s" fill="freeze" />
    </text>
    <!-- 边界线 - 树2 (简单水平线) -->
    <line id="tree2-boundary" x1="-180" y1="50" x2="180" y2="50" stroke="#66bb6a" stroke-width="2" stroke-opacity="0" stroke-dasharray="5,3">
      <animate attributeName="stroke-opacity" from="0" to="0.7" dur="1s" begin="1.5s" fill="freeze" />
    </line>
    <text x="-160" y="40" text-anchor="start" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#66bb6a" opacity="0">
      树2边界
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="2s" fill="freeze" />
    </text>
    <!-- 边界线 - 树3 (对角线) -->
    <line id="tree3-boundary" x1="-180" y1="-130" x2="180" y2="130" stroke="#81c784" stroke-width="2" stroke-opacity="0" stroke-dasharray="5,3">
      <animate attributeName="stroke-opacity" from="0" to="0.7" dur="1s" begin="2.5s" fill="freeze" />
    </line>
    <text x="160" y="110" text-anchor="end" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#81c784" opacity="0">
      树3边界
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="3s" fill="freeze" />
    </text>
    <!-- 组合标签 -->
    <text x="0" y="-135" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="bold" fill="#2e7d32" opacity="0">
      多个决策边界通过投票组合
      <animate attributeName="opacity" from="0" to="1" dur="1s" begin="4s" fill="freeze" />
    </text>
    <!-- 测试数据点 - 随机森林 -->
    <g>
      <circle id="rf-test-point" cx="-100" cy="0" r="8" fill="yellow" stroke="#333" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="4.5s" fill="freeze" />
      </circle>
      <text x="-100" y="-12" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#333" opacity="0">
        测试点
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="4.5s" fill="freeze" />
      </text>
    </g>
    <!-- 预测箭头 - 随机森林 -->
    <g opacity="0">
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="5s" fill="freeze" />
      <path d="M-100,0 C-70,-20 -30,-20 0,-10" stroke="#2e7d32" stroke-width="1.5" fill="none" stroke-dasharray="4,2" marker-end="url(#arrowhead)" />
      <path d="M-100,0 C-70,20 -30,20 0,10" stroke="#2e7d32" stroke-width="1.5" fill="none" stroke-dasharray="4,2" marker-end="url(#arrowhead)" />
      <path d="M-100,0 C-70,0 -30,0 0,0" stroke="#2e7d32" stroke-width="1.5" fill="none" stroke-dasharray="4,2" marker-end="url(#arrowhead)" />
      <circle cx="0" cy="-10" r="5" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <text x="10" y="-10" text-anchor="start" font-family="'Segoe UI', Arial, sans-serif" font-size="10" fill="#333">树1预测：类别1</text>
      <circle cx="0" cy="10" r="5" fill="url(#class2RF)" stroke="#e64a19" stroke-width="1" />
      <text x="10" y="10" text-anchor="start" font-family="'Segoe UI', Arial, sans-serif" font-size="10" fill="#333">树2预测：类别2</text>
      <circle cx="0" cy="0" r="5" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1" />
      <text x="10" y="0" text-anchor="start" font-family="'Segoe UI', Arial, sans-serif" font-size="10" fill="#333">树3预测：类别1</text>
    </g>
    <!-- 最终预测 - 随机森林 -->
    <g opacity="0">
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="6s" fill="freeze" />
      <rect x="100" y="-40" width="70" height="80" rx="5" fill="#f5f5f5" stroke="#2e7d32" stroke-width="1.5" />
      <text x="135" y="-20" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" font-weight="bold" fill="#2e7d32">投票结果</text>
      <text x="135" y="0" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#333">类别1: 2票</text>
      <text x="135" y="20" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#333">类别2: 1票</text>
      <circle cx="135" cy="40" r="8" fill="url(#class1RF)" stroke="#388e3c" stroke-width="1.5" />
    </g>
  </g>
  <!-- 右侧：梯度提升可视化 -->
  <g transform="translate(720, 300)">
    <!-- 数据空间背景 -->
    <rect x="-200" y="-150" width="400" height="300" rx="5" fill="url(#dataPlotGradient)" stroke="#ddd" stroke-width="1" filter="url(#dropShadow)" />
    <!-- 坐标轴 -->
    <line x1="-180" y1="130" x2="180" y2="130" stroke="#999" stroke-width="1" />
    <line x1="-180" y1="-130" x2="-180" y2="130" stroke="#999" stroke-width="1" />
    <text x="0" y="145" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#666">特征 1</text>
    <text x="-195" y="0" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#666" transform="rotate(-90, -195, 0)">特征 2</text>
    <!-- 数据点 - 静态部分 -->
    <g>
      <!-- 类别1数据点 -->
      <circle cx="-140" cy="-100" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-120" cy="-80" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-110" cy="-110" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-90" cy="-90" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-80" cy="-120" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-70" cy="-60" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-50" cy="-70" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="-30" cy="80" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="0" cy="90" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="20" cy="100" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="40" cy="70" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <circle cx="60" cy="110" r="6" fill="url(#class1GB)" stroke="#1565c0" stroke-width="1" />
      <!-- 类别2数据点 -->
      <circle cx="-30" cy="10" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="-10" cy="-10" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="10" cy="20" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="20" cy="-20" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="30" cy="0" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="40" cy="-30" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="50" cy="10" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="70" cy="-70" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="90" cy="-40" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="110" cy="-90" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="130" cy="-60" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
      <circle cx="150" cy="-100" r="6" fill="url(#class2GB)" stroke="#e64a19" stroke-width="1" />
    </g>
    <!-- 初始预测错误点 -->
    <g opacity="0">
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="0.5s" fill="freeze" />
      <circle cx="100" cy="20" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" />
      <circle cx="60" cy="0" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" />
      <circle cx="20" cy="-50" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" />
      <circle cx="-40" cy="40" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" />
      <circle cx="-90" cy="-20" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" />
      <text x="0" y="-135" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565c0">
        第一棵树的预测误差
      </text>
    </g>
    <!-- 树1决策边界 -->
    <path id="gb-tree1-boundary" d="M-180,30 L180,30" stroke="#1565c0" stroke-width="2" stroke-opacity="0" stroke-dasharray="5,3">
      <animate attributeName="stroke-opacity" from="0" to="0.7" dur="1s" begin="1.5s" fill="freeze" />
    </path>
    <text x="-160" y="20" text-anchor="start" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#1565c0" opacity="0">
      树1边界
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="2s" fill="freeze" />
    </text>
    <!-- 树2决策边界 -->
    <path id="gb-tree2-boundary" d="M-50,-130 L-50,130" stroke="#42a5f5" stroke-width="2" stroke-opacity="0" stroke-dasharray="5,3">
      <animate attributeName="stroke-opacity" from="0" to="0.7" dur="1s" begin="3.5s" fill="freeze" />
    </path>
    <text x="-50" y="-120" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#42a5f5" opacity="0">
      树2边界
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="4s" fill="freeze" />
    </text>
    <!-- 残差减少动画 -->
    <g>
      <!-- 错误点1逐渐缩小 -->
      <circle cx="100" cy="20" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="2.5s" fill="freeze" />
        <animate attributeName="r" values="8;6;4" dur="1s" begin="2.5s" fill="freeze" />
      </circle>
      <!-- 错误点2逐渐缩小 -->
      <circle cx="60" cy="0" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="2.7s" fill="freeze" />
        <animate attributeName="r" values="8;6;4" dur="1s" begin="2.7s" fill="freeze" />
      </circle>
      <!-- 错误点3逐渐缩小 -->
      <circle cx="20" cy="-50" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="2.9s" fill="freeze" />
        <animate attributeName="r" values="8;3;2" dur="1s" begin="2.9s" fill="freeze" />
      </circle>
      <!-- 错误点4逐渐缩小 -->
      <circle cx="-40" cy="40" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="3.1s" fill="freeze" />
        <animate attributeName="r" values="8;5;3" dur="1s" begin="3.1s" fill="freeze" />
      </circle>
      <!-- 错误点5逐渐缩小 -->
      <circle cx="-90" cy="-20" r="8" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="3.3s" fill="freeze" />
        <animate attributeName="r" values="8;4;2" dur="1s" begin="3.3s" fill="freeze" />
      </circle>
    </g>
    <!-- 树2后的残差进一步减少 -->
    <g>
      <!-- 错误点1继续缩小 -->
      <circle cx="100" cy="20" r="4" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="4.5s" fill="freeze" />
        <animate attributeName="r" values="4;2;1" dur="1s" begin="4.5s" fill="freeze" />
      </circle>
      <!-- 错误点2继续缩小 -->
      <circle cx="60" cy="0" r="4" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="4.7s" fill="freeze" />
        <animate attributeName="r" values="4;2;1" dur="1s" begin="4.7s" fill="freeze" />
      </circle>
      <!-- 错误点3继续缩小 -->
      <circle cx="20" cy="-50" r="2" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="4.9s" fill="freeze" />
        <animate attributeName="r" values="2;1;0.5" dur="1s" begin="4.9s" fill="freeze" />
      </circle>
      <!-- 错误点4继续缩小 -->
      <circle cx="-40" cy="40" r="3" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="5.1s" fill="freeze" />
        <animate attributeName="r" values="3;1.5;0.5" dur="1s" begin="5.1s" fill="freeze" />
      </circle>
      <!-- 错误点5继续缩小 -->
      <circle cx="-90" cy="-20" r="2" fill="url(#errorPoint)" stroke="#d32f2f" stroke-width="1.5" opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="5.3s" fill="freeze" />
        <animate attributeName="r" values="2;1;0.5" dur="1s" begin="5.3s" fill="freeze" />
      </circle>
    </g>
    <!-- 最终结果文本 -->
    <text x="0" y="-135" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565c0" opacity="0">
      通过逐步修正误差提高预测准确性
      <animate attributeName="opacity" from="0" to="0" dur="0.1s" begin="3s" fill="freeze" />
      <animate attributeName="opacity" from="0" to="1" dur="1s" begin="5.5s" fill="freeze" />
    </text>
    <!-- 最终预测 - 梯度提升 -->
    <g opacity="0">
      <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="6s" fill="freeze" />
      <rect x="100" y="-40" width="70" height="80" rx="5" fill="#f5f5f5" stroke="#1565c0" stroke-width="1.5" />
      <text x="135" y="-20" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" font-weight="bold" fill="#1565c0">最终模型</text>
      <text x="135" y="0" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#333">树1 + 树2 +...</text>
      <text x="135" y="20" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#333">误差显著降低</text>
      <circle cx="135" cy="40" r="8" fill="#64b5f6" stroke="#1565c0" stroke-width="1.5" />
    </g>
  </g>
  <!-- 底部对比说明 -->
  <g transform="translate(480, 520)">
    <!-- 左侧：随机森林特点 -->
    <g transform="translate(-215, 0)">
      <rect x="-150" y="-25" width="300" height="50" rx="5" fill="#f5f5f5" stroke="#43a047" stroke-width="1.5" filter="url(#dropShadow)" />
      <text x="0" y="-5" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="bold" fill="#2e7d32">随机森林特点</text>
      <text x="0" y="15" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="13" fill="#333">各树独立训练，通过集成降低方差，增强稳健性</text>
      <!-- 并行指示图标 -->
      <g transform="translate(130, -5)">
        <line x1="-10" y1="-10" x2="-10" y2="10" stroke="#43a047" stroke-width="3" />
        <line x1="0" y1="-10" x2="0" y2="10" stroke="#43a047" stroke-width="3" />
        <line x1="10" y1="-10" x2="10" y2="10" stroke="#43a047" stroke-width="3" />
      </g>
    </g>
    <!-- 右侧：梯度提升特点 -->
    <g transform="translate(215, 0)">
      <rect x="-150" y="-25" width="300" height="50" rx="5" fill="#f5f5f5" stroke="#1976d2" stroke-width="1.5" filter="url(#dropShadow)" />
      <text x="0" y="-5" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565c0">梯度提升特点</text>
      <text x="0" y="15" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="13" fill="#333">序列训练，每棵树专注修正前树错误，提高准确性</text>
      <!-- 串行指示图标 -->
      <g transform="translate(130, -5)">
        <line x1="-12" y1="-10" x2="12" y2="-10" stroke="#1976d2" stroke-width="3" />
        <line x1="-12" y1="0" x2="12" y2="0" stroke="#1976d2" stroke-width="3" />
        <line x1="-12" y1="10" x2="12" y2="10" stroke="#1976d2" stroke-width="3" />
      </g>
    </g>
  </g>
</svg>
<h3 id="21-随机森林并行集成"><a class="markdownIt-Anchor" href="#21-随机森林并行集成"></a> 2.1 随机森林：并行集成</h3>
<p>随机森林采用<strong>并行策略</strong>：</p>
<ol>
<li>从原始数据中有放回地抽样生成多个数据子集（Bootstrap抽样）</li>
<li>对每个子集训练一棵决策树，同时在每个节点随机选择特征子集</li>
<li>所有树独立训练，最终通过投票或平均汇总结果</li>
</ol>
<p>这种&quot;民主投票&quot;机制显著降低了过拟合风险，但无法纠正模型的系统性偏差。</p>
<h3 id="22-梯度提升序列集成"><a class="markdownIt-Anchor" href="#22-梯度提升序列集成"></a> 2.2 梯度提升：序列集成</h3>
<p>梯度提升采用<strong>串行策略</strong>，每棵新树都专注于修正前面树的错误：</p>
<ol>
<li>训练第一棵树拟合原始数据</li>
<li>计算残差（实际值与预测值的差）</li>
<li>训练下一棵树拟合这些残差</li>
<li>将新树添加到模型中，更新预测</li>
<li>重复步骤2-4，直到满足停止条件</li>
</ol>
<p>以回归问题为例，假设我们有N个样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">\{(x_i, y_i)\}_{i=1}^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0999949999999998em;vertical-align:-0.258664em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span>。在第m轮迭代中：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>γ</mi><mi>m</mi></msub><msub><mi>h</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_m(x) = F_{m-1}(x) + \gamma_m h_m(x)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_m(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>是当前模型，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_m(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>是新加入的树，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是学习率。新树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">h_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>通过最小化损失函数来训练：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>m</mi></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo><mi>min</mi><mo>⁡</mo></mo><mi>h</mi></munder><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>F</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_m = \arg\min_h \sum_{i=1}^N L(y_i, F_{m-1}(x_i) + h(x_i))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="3-xgboost梯度提升的艺术结晶"><a class="markdownIt-Anchor" href="#3-xgboost梯度提升的艺术结晶"></a> 3. XGBoost：梯度提升的艺术结晶</h2>
<p>XGBoost（eXtreme Gradient Boosting）在传统梯度提升的基础上引入了一系列创新，从算法到工程实现都进行了全面优化。</p>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 550">
  <!-- 背景 -->
  <rect width="800" height="550" fill="white"/>
  <!-- 标题 -->
  <text x="400" y="30" text-anchor="middle" font-size="18" font-weight="bold">XGBoost的技术创新与优化</text>
  <!-- 左侧：传统GBDT与XGBoost的对比 -->
  <g transform="translate(50, 70)">
    <text x="150" y="0" text-anchor="middle" font-size="16" font-weight="bold">从GBDT到XGBoost的演进</text>
    <!-- 传统GBDT方框 -->
    <rect x="0" y="20" width="300" height="150" rx="10" fill="#f9f9f9" stroke="#666" stroke-width="1.5"/>
    <text x="150" y="40" text-anchor="middle" font-size="14" font-weight="bold">传统梯度提升决策树(GBDT)</text>
    <g transform="translate(20, 60)">
      <text x="0" y="0" font-size="12">• 一阶导数优化</text>
      <text x="0" y="25" font-size="12">• 贪心分裂</text>
      <text x="0" y="50" font-size="12">• 无内置正则化</text>
      <text x="0" y="75" font-size="12">• 对缺失值敏感</text>
      <text x="0" y="100" font-size="12">• 计算效率低</text>
    </g>
    <!-- 箭头 -->
    <g transform="translate(150, 180)">
      <line x1="0" y1="0" x2="0" y2="40" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
      <text x="30" y="20" font-size="12">优化</text>
    </g>
    <!-- XGBoost方框 -->
    <rect x="0" y="230" width="300" height="180" rx="10" fill="#e6f7ff" stroke="#0066cc" stroke-width="2"/>
    <text x="150" y="250" text-anchor="middle" font-size="14" font-weight="bold">XGBoost创新</text>
    <g transform="translate(20, 270)">
      <text x="0" y="0" font-size="12" fill="#0066cc">• 二阶泰勒展开优化</text>
      <text x="0" y="25" font-size="12" fill="#0066cc">• 正则化目标函数</text>
      <text x="0" y="50" font-size="12" fill="#0066cc">• 特征分桶与近似算法</text>
      <text x="0" y="75" font-size="12" fill="#0066cc">• 智能处理缺失值</text>
      <text x="0" y="100" font-size="12" fill="#0066cc">• 列块并行计算</text>
      <text x="0" y="125" font-size="12" fill="#0066cc">• 预排序与缓存优化</text>
    </g>
  </g>
  <!-- 右侧：XGBoost核心算法原理 -->
  <g transform="translate(400, 70)">
    <text x="170" y="0" text-anchor="middle" font-size="16" font-weight="bold">XGBoost的核心算法原理</text>
    <!-- 目标函数 -->
    <g transform="translate(50, 30)">
      <rect x="0" y="0" width="240" height="70" rx="5" fill="#f5f5f5" stroke="#333" stroke-width="1.5"/>
      <text x="120" y="20" text-anchor="middle" font-size="14" font-weight="bold">正则化目标函数</text>
      <text x="120" y="45" text-anchor="middle" font-size="12" font-family="monospace">Obj = L(y,ŷ) + Ω(f)</text>
      <text x="5" y="65" font-size="10" fill="#666">损失函数 + 正则化项</text>
    </g>
    <!-- 泰勒展开 -->
    <g transform="translate(50, 120)">
      <rect x="0" y="0" width="240" height="80" rx="5" fill="#f5f5f5" stroke="#333" stroke-width="1.5"/>
      <text x="120" y="20" text-anchor="middle" font-size="14" font-weight="bold">二阶泰勒展开</text>
      <text x="120" y="45" text-anchor="middle" font-size="12" font-family="monospace">L ≈ L₀ + g·f(x) + ½·h·f²(x)</text>
      <text x="5" y="65" font-size="10" fill="#666">g: 一阶导数, h: 二阶导数</text>
    </g>
    <!-- 树生长算法 -->
    <g transform="translate(50, 220)">
      <rect x="0" y="0" width="240" height="130" rx="5" fill="#f5f5f5" stroke="#333" stroke-width="1.5"/>
      <text x="120" y="20" text-anchor="middle" font-size="14" font-weight="bold">树分裂算法</text>
      <text x="5" y="45" font-size="12">分裂增益:</text>
      <text x="120" y="70" text-anchor="middle" font-size="12" font-family="monospace">Gain = ½·[G²ₗ/(Hₗ+λ) + G²ᵣ/(Hᵣ+λ)</text>
      <text x="120" y="90" text-anchor="middle" font-size="12" font-family="monospace">      - (Gₗ+Gᵣ)²/(Hₗ+Hᵣ+λ)] - γ</text>
      <text x="5" y="115" font-size="10" fill="#666">考虑二阶导数的分裂标准</text>
    </g>
    <!-- 系统优化 -->
    <g transform="translate(50, 370)">
      <rect x="0" y="0" width="240" height="100" rx="5" fill="#e6f7ff" stroke="#0066cc" stroke-width="1.5"/>
      <text x="120" y="20" text-anchor="middle" font-size="14" font-weight="bold">系统工程优化</text>
      <g transform="translate(10, 35)">
        <text x="0" y="0" font-size="12">• 块结构数据存储</text>
        <text x="0" y="20" font-size="12">• 特征并行与数据并行</text>
        <text x="0" y="40" font-size="12">• 缓存感知访问</text>
        <text x="0" y="60" font-size="12">• 外存计算支持</text>
      </g>
    </g>
  </g>
  <!-- 箭头定义 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
</svg>
<h3 id="31-正则化目标函数"><a class="markdownIt-Anchor" href="#31-正则化目标函数"></a> 3.1 正则化目标函数</h3>
<p>XGBoost的第一个创新是将正则化项引入目标函数：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Obj</mtext><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Obj} = \sum_{i=1}^n L(y_i, \hat{y}_i) + \sum_{j=1}^T \Omega(f_j)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Obj</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2421130000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mi>γ</mi><mi>T</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>λ</mi><mi mathvariant="normal">∥</mi><mi>w</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Omega(f) = \gamma T + \frac{1}{2}\lambda\|w\|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>，惩罚项包含叶子数量T和叶子权重w的L2范数。这有效地控制了模型复杂度，防止过拟合。</p>
<h3 id="32-二阶泰勒展开优化"><a class="markdownIt-Anchor" href="#32-二阶泰勒展开优化"></a> 3.2 二阶泰勒展开优化</h3>
<p>XGBoost使用损失函数的二阶泰勒展开：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msub><mi>f</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>≈</mo><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo><mo>+</mo><msub><mi>g</mi><mi>i</mi></msub><msub><mi>f</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>h</mi><mi>i</mi></msub><msubsup><mi>f</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(y_i, \hat{y}_i^{(t-1)} + f_t(x_i)) \approx L(y_i, \hat{y}_i^{(t-1)}) + g_i f_t(x_i) + \frac{1}{2}h_i f_t^2(x_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.276864em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.276864em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><msub><mi mathvariant="normal">∂</mi><msup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></msub><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_i = \partial_{\hat{y}^{(t-1)}} L(y_i, \hat{y}^{(t-1)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2547329999999999em;vertical-align:-0.366733em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.366733em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi mathvariant="normal">∂</mi><msup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mn>2</mn></msubsup><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_i = \partial_{\hat{y}^{(t-1)}}^2 L(y_i, \hat{y}^{(t-1)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3965329999999998em;vertical-align:-0.508533em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.3275750000000004em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.508533em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>分别是一阶和二阶导数。</p>
<p>这种方法比传统的梯度下降更精确，因为它考虑了曲率信息，使得优化过程更加高效。</p>
<h3 id="33-贪心算法与近似分割"><a class="markdownIt-Anchor" href="#33-贪心算法与近似分割"></a> 3.3 贪心算法与近似分割</h3>
<p>XGBoost采用贪心算法寻找最佳分割点，并引入近似算法加速计算：</p>
<ol>
<li><strong>全局算法</strong>：预先对特征值排序，扫描所有可能的分割点</li>
<li><strong>近似算法</strong>：基于分位点创建候选分割点集合，显著提高大数据集处理速度</li>
</ol>
<p>定义增益函数：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Gain</mtext><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">[</mo><mfrac><msubsup><mi>G</mi><mi>L</mi><mn>2</mn></msubsup><mrow><msub><mi>H</mi><mi>L</mi></msub><mo>+</mo><mi>λ</mi></mrow></mfrac><mo>+</mo><mfrac><msubsup><mi>G</mi><mi>R</mi><mn>2</mn></msubsup><mrow><msub><mi>H</mi><mi>R</mi></msub><mo>+</mo><mi>λ</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>G</mi><mi>L</mi></msub><mo>+</mo><msub><mi>G</mi><mi>R</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><msub><mi>H</mi><mi>L</mi></msub><mo>+</mo><msub><mi>H</mi><mi>R</mi></msub><mo>+</mo><mi>λ</mi></mrow></mfrac><mo fence="true">]</mo></mrow><mo>−</mo><mi>γ</mi></mrow><annotation encoding="application/x-tex">\text{Gain} = \frac{1}{2} \left[ \frac{G_L^2}{H_L + \lambda} + \frac{G_R^2}{H_R + \lambda} - \frac{(G_L + G_R)^2}{H_L + H_R + \lambda} \right] - \gamma
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Gain</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.441138em;vertical-align:-0.95003em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.275331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.275331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span>分别是梯度和Hessian的和。</p>
<h3 id="34-缺失值处理的巧妙设计"><a class="markdownIt-Anchor" href="#34-缺失值处理的巧妙设计"></a> 3.4 缺失值处理的巧妙设计</h3>
<p>XGBoost对缺失值的处理格外巧妙：</p>
<ol>
<li>在训练时，为每个节点额外学习一个默认方向</li>
<li>当样本在特征上有缺失值时，将其分配到默认方向</li>
<li>默认方向通过尝试两种可能并选择增益最大的方向确定</li>
</ol>
<p>这种设计不仅处理了缺失值，还利用稀疏性提高了计算效率。</p>
<h3 id="35-系统设计与工程优化"><a class="markdownIt-Anchor" href="#35-系统设计与工程优化"></a> 3.5 系统设计与工程优化</h3>
<p>XGBoost的成功不仅在于算法设计，还在于系统实现的优化：</p>
<ul>
<li><strong>块结构数据压缩</strong>：预排序并存储为块，减少内存使用和计算开销</li>
<li><strong>缓存感知访问</strong>：优化数据结构，提高CPU缓存命中率</li>
<li><strong>&quot;开箱即用&quot;的并行处理</strong>：利用多核性能，特征级并行化建树</li>
<li><strong>分布式计算</strong>：支持分布式训练，处理超大规模数据</li>
</ul>
<h2 id="4-xgboost与其他算法的对比分析"><a class="markdownIt-Anchor" href="#4-xgboost与其他算法的对比分析"></a> 4. XGBoost与其他算法的对比分析</h2>
<p>为了更全面理解XGBoost的优势，我们将其与其他主流算法进行对比：</p>
<table>
<thead>
<tr>
<th>算法</th>
<th>优势</th>
<th>局限性</th>
</tr>
</thead>
<tbody>
<tr>
<td>线性模型</td>
<td>解释性强，训练快速</td>
<td>无法捕捉非线性关系</td>
</tr>
<tr>
<td>决策树</td>
<td>直观易懂，处理各类数据</td>
<td>容易过拟合，不稳定</td>
</tr>
<tr>
<td>随机森林</td>
<td>稳定性好，参数少</td>
<td>对极端非线性关系把握不足</td>
</tr>
<tr>
<td>普通GBDT</td>
<td>预测精度高</td>
<td>易过拟合，速度慢</td>
</tr>
<tr>
<td><strong>XGBoost</strong></td>
<td>精度高，速度快，防过拟合</td>
<td>参数调优复杂，黑盒性质</td>
</tr>
<tr>
<td>LightGBM</td>
<td>更轻量级，训练更快</td>
<td>小数据集上可能表现不佳</td>
</tr>
</tbody>
</table>
<h3 id="41-何时选择xgboost"><a class="markdownIt-Anchor" href="#41-何时选择xgboost"></a> 4.1 何时选择XGBoost？</h3>
<p>XGBoost在以下场景中特别有效：</p>
<ul>
<li>中等规模的结构化数据（几千至几百万样本）</li>
<li>特征间存在复杂交互的问题</li>
<li>需要高预测精度且有一定计算资源的场景</li>
<li>分类、回归、排序等多种监督学习任务</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># XGBoost的基本使用示例</span><br><span class="hljs-keyword">import</span> xgboost <span class="hljs-keyword">as</span> xgb<br><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># 加载数据</span><br>data = load_boston()<br>X, y = data.data, data.target<br><br><span class="hljs-comment"># 划分训练集和测试集</span><br>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)<br><br><span class="hljs-comment"># 创建DMatrix对象（XGBoost的数据格式）</span><br>dtrain = xgb.DMatrix(X_train, label=y_train)<br>dtest = xgb.DMatrix(X_test, label=y_test)<br><br><span class="hljs-comment"># 设置参数</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;objective&#x27;</span>: <span class="hljs-string">&#x27;reg:squarederror&#x27;</span>,  <span class="hljs-comment"># 回归任务</span><br>    <span class="hljs-string">&#x27;learning_rate&#x27;</span>: <span class="hljs-number">0.1</span>,<br>    <span class="hljs-string">&#x27;max_depth&#x27;</span>: <span class="hljs-number">5</span>,<br>    <span class="hljs-string">&#x27;min_child_weight&#x27;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&#x27;subsample&#x27;</span>: <span class="hljs-number">0.8</span>,<br>    <span class="hljs-string">&#x27;colsample_bytree&#x27;</span>: <span class="hljs-number">0.8</span>,<br>    <span class="hljs-string">&#x27;eta&#x27;</span>: <span class="hljs-number">0.1</span>,<br>    <span class="hljs-string">&#x27;seed&#x27;</span>: <span class="hljs-number">42</span><br>&#125;<br><br><span class="hljs-comment"># 训练模型</span><br>num_rounds = <span class="hljs-number">100</span><br>model = xgb.train(params, dtrain, num_rounds)<br><br><span class="hljs-comment"># 预测</span><br>preds = model.predict(dtest)<br><br><span class="hljs-comment"># 评估</span><br>rmse = np.sqrt(mean_squared_error(y_test, preds))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;RMSE: <span class="hljs-subst">&#123;rmse&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 特征重要性</span><br>importance = model.get_score(importance_type=<span class="hljs-string">&#x27;gain&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="5-xgboost的高级应用与调优"><a class="markdownIt-Anchor" href="#5-xgboost的高级应用与调优"></a> 5. XGBoost的高级应用与调优</h2>
<p>理解了XGBoost的原理后，如何在实际应用中充分发挥其潜力？</p>
<h3 id="51-关键参数调优策略"><a class="markdownIt-Anchor" href="#51-关键参数调优策略"></a> 5.1 关键参数调优策略</h3>
<p>XGBoost有近10个重要参数，以下是调优的基本策略：</p>
<ol>
<li>
<p><strong>控制复杂度参数</strong>：</p>
<ul>
<li><code>max_depth</code>：控制树深度，通常在3-10之间</li>
<li><code>min_child_weight</code>：控制叶节点的最小样本权重和</li>
<li><code>gamma</code>：控制节点分裂的最小损失减少值</li>
</ul>
</li>
<li>
<p><strong>防止过拟合参数</strong>：</p>
<ul>
<li><code>subsample</code>：样本抽样比例</li>
<li><code>colsample_bytree</code>：特征抽样比例</li>
<li><code>lambda</code>和<code>alpha</code>：L2和L1正则化参数</li>
</ul>
</li>
<li>
<p><strong>学习率与迭代次数</strong>：</p>
<ul>
<li>降低<code>learning_rate</code>（通常0.01-0.1）</li>
<li>同时增加<code>n_estimators</code>（树的数量）</li>
</ul>
</li>
</ol>
<p><strong>调参的一般流程</strong>：</p>
<ol>
<li>选择一个相对高的学习率（0.1）</li>
<li>确定最优的树复杂度参数</li>
<li>调整随机性参数（抽样参数）减少过拟合</li>
<li>调整正则化参数</li>
<li>降低学习率，增加树的数量，进行最终微调</li>
</ol>
<h3 id="52-从实践中理解xgboost"><a class="markdownIt-Anchor" href="#52-从实践中理解xgboost"></a> 5.2 从实践中理解XGBoost</h3>
<p>为了直观理解XGBoost的工作机制，我们来跟踪一个简单回归问题的训练过程：</p>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500" style="background-color: #f8fafc;">
  <defs>
    <!-- 渐变定义 -->
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#4a5568" />
      <stop offset="100%" stop-color="#2d3748" />
    </linearGradient>
    <linearGradient id="tree1Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#fc8181" />
      <stop offset="100%" stop-color="#e53e3e" />
    </linearGradient>
    <linearGradient id="tree2Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#4fd1c5" />
      <stop offset="100%" stop-color="#319795" />
    </linearGradient>
    <linearGradient id="tree3Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#90cdf4" />
      <stop offset="100%" stop-color="#4299e1" />
    </linearGradient>
    <linearGradient id="finalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#667eea" />
      <stop offset="100%" stop-color="#764ba2" />
    </linearGradient>
    <linearGradient id="gridGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#f7fafc" />
      <stop offset="100%" stop-color="#edf2f7" />
    </linearGradient>
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="2" />
      <feOffset dx="1" dy="1" result="offsetblur" />
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.3" />
      </feComponentTransfer>
      <feMerge>
        <feMergeNode />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="2" result="blur" />
      <feComponentTransfer in="blur" result="glow">
        <feFuncA type="linear" slope="1" intercept="0" />
      </feComponentTransfer>
      <feMerge>
        <feMergeNode in="glow" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <!-- 箭头标记 -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L0,7 L9,3.5 Z" fill="#718096" />
    </marker>
    <marker id="redArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L0,7 L9,3.5 Z" fill="#e53e3e" />
    </marker>
    <marker id="tealArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L0,7 L9,3.5 Z" fill="#319795" />
    </marker>
    <marker id="blueArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L0,7 L9,3.5 Z" fill="#4299e1" />
    </marker>
    <marker id="purpleArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M0,0 L0,7 L9,3.5 Z" fill="#6b46c1" />
    </marker>
  </defs>
  <!-- 背景 -->
  <rect width="900" height="500" fill="#f8fafc" />
  <!-- 标题栏 -->
  <rect x="0" y="0" width="900" height="60" fill="url(#headerGrad)" />
  <text x="450" y="38" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="24" font-weight="bold" fill="white">XGBoost训练过程：逐步构建强大模型</text>
  <!-- 图表区域 -->
  <g transform="translate(80, 80)">
    <!-- 图表背景和网格 -->
    <rect x="0" y="0" width="740" height="320" rx="5" fill="url(#gridGrad)" stroke="#e2e8f0" stroke-width="1" filter="url(#dropShadow)" />
    <!-- 网格线 -->
    <line x1="0" y1="80" x2="740" y2="80" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,3" />
    <line x1="0" y1="160" x2="740" y2="160" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,3" />
    <line x1="0" y1="240" x2="740" y2="240" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,3" />
    <line x1="185" y1="0" x2="185" y2="320" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,3" />
    <line x1="370" y1="0" x2="370" y2="320" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,3" />
    <line x1="555" y1="0" x2="555" y2="320" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="3,3" />
    <!-- 坐标轴 -->
    <line x1="0" y1="320" x2="740" y2="320" stroke="#4a5568" stroke-width="2" />
    <line x1="0" y1="0" x2="0" y2="320" stroke="#4a5568" stroke-width="2" />
    <!-- X轴标签 -->
    <text x="370" y="350" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="16" font-weight="bold" fill="#4a5568">特征 X</text>
    <!-- Y轴标签 -->
    <text x="-40" y="160" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="16" font-weight="bold" fill="#4a5568" transform="rotate(-90, -40, 160)">目标值 Y</text>
    <!-- 刻度 -->
    <g>
      <line x1="0" y1="320" x2="0" y2="325" stroke="#4a5568" stroke-width="2" />
      <text x="0" y="340" text-anchor="middle" font-size="12" fill="#4a5568">0</text>
      <line x1="185" y1="320" x2="185" y2="325" stroke="#4a5568" stroke-width="2" />
      <text x="185" y="340" text-anchor="middle" font-size="12" fill="#4a5568">1</text>
      <line x1="370" y1="320" x2="370" y2="325" stroke="#4a5568" stroke-width="2" />
      <text x="370" y="340" text-anchor="middle" font-size="12" fill="#4a5568">2</text>
      <line x1="555" y1="320" x2="555" y2="325" stroke="#4a5568" stroke-width="2" />
      <text x="555" y="340" text-anchor="middle" font-size="12" fill="#4a5568">3</text>
      <line x1="740" y1="320" x2="740" y2="325" stroke="#4a5568" stroke-width="2" />
      <text x="740" y="340" text-anchor="middle" font-size="12" fill="#4a5568">4</text>
      <line x1="0" y1="320" x2="-5" y2="320" stroke="#4a5568" stroke-width="2" />
      <text x="-15" y="325" text-anchor="end" font-size="12" fill="#4a5568">0</text>
      <line x1="0" y1="240" x2="-5" y2="240" stroke="#4a5568" stroke-width="2" />
      <text x="-15" y="245" text-anchor="end" font-size="12" fill="#4a5568">2</text>
      <line x1="0" y1="160" x2="-5" y2="160" stroke="#4a5568" stroke-width="2" />
      <text x="-15" y="165" text-anchor="end" font-size="12" fill="#4a5568">4</text>
      <line x1="0" y1="80" x2="-5" y2="80" stroke="#4a5568" stroke-width="2" />
      <text x="-15" y="85" text-anchor="end" font-size="12" fill="#4a5568">6</text>
      <line x1="0" y1="0" x2="-5" y2="0" stroke="#4a5568" stroke-width="2" />
      <text x="-15" y="5" text-anchor="end" font-size="12" fill="#4a5568">8</text>
    </g>
    <!-- 数据点 - 带动画 -->
    <g>
      <circle cx="50" cy="200" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.1s" fill="freeze" />
      </circle>
      <circle cx="100" cy="150" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.2s" fill="freeze" />
      </circle>
      <circle cx="150" cy="170" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.3s" fill="freeze" />
      </circle>
      <circle cx="200" cy="100" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.4s" fill="freeze" />
      </circle>
      <circle cx="250" cy="120" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.5s" fill="freeze" />
      </circle>
      <circle cx="300" cy="90" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.6s" fill="freeze" />
      </circle>
      <circle cx="350" cy="80" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.7s" fill="freeze" />
      </circle>
      <circle cx="400" cy="120" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.8s" fill="freeze" />
      </circle>
      <circle cx="450" cy="150" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="0.9s" fill="freeze" />
      </circle>
      <circle cx="500" cy="180" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="1.0s" fill="freeze" />
      </circle>
      <circle cx="550" cy="200" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="1.1s" fill="freeze" />
      </circle>
      <circle cx="600" cy="220" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="1.2s" fill="freeze" />
      </circle>
      <circle cx="650" cy="240" r="0" fill="#2d3748" filter="url(#glow)">
        <animate attributeName="r" from="0" to="6" dur="0.3s" begin="1.3s" fill="freeze" />
      </circle>
    </g>
    <!-- 阶段1：初始预测 -->
    <g>
      <!-- 平均线 -->
      <path d="M0,220 L740,220" stroke="#718096" stroke-width="3" stroke-dasharray="740" stroke-dashoffset="740">
        <animate attributeName="stroke-dashoffset" from="740" to="0" dur="1s" begin="1.5s" fill="freeze" />
      </path>
      <!-- 标签 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="2.5s" fill="freeze" />
        <rect x="580" y="190" width="150" height="25" rx="5" fill="#f8fafc" stroke="#718096" stroke-width="1" />
        <text x="655" y="207" text-anchor="middle" font-size="14" fill="#718096">初始预测：常数值</text>
      </g>
      <!-- 误差线动画 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="3s" fill="freeze" />
        <line x1="200" y1="100" x2="200" y2="220" stroke="#e53e3e" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="350" y1="80" x2="350" y2="220" stroke="#e53e3e" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="500" y1="180" x2="500" y2="220" stroke="#e53e3e" stroke-width="1.5" stroke-dasharray="3,2" />
        <!-- 误差标签 -->
        <text x="175" y="160" text-anchor="middle" font-size="12" fill="#e53e3e" transform="rotate(-90, 175, 160)">误差</text>
        <text x="325" y="150" text-anchor="middle" font-size="12" fill="#e53e3e" transform="rotate(-90, 325, 150)">误差</text>
        <text x="475" y="200" text-anchor="middle" font-size="12" fill="#e53e3e" transform="rotate(-90, 475, 200)">误差</text>
      </g>
    </g>
    <!-- 阶段2：第一棵树的贡献 -->
    <g>
      <!-- 微型树图标 -->
      <g opacity="0" transform="translate(40, 30)">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="4s" fill="freeze" />
        <rect x="0" y="0" width="60" height="70" rx="5" fill="#fff1f0" stroke="#e53e3e" stroke-width="1.5" />
        <text x="30" y="20" text-anchor="middle" font-size="12" font-weight="bold" fill="#e53e3e">树 1</text>
        <!-- 简化树图形 -->
        <line x1="15" y1="30" x2="45" y2="30" stroke="#e53e3e" stroke-width="1.5" />
        <line x1="30" y1="30" x2="20" y2="50" stroke="#e53e3e" stroke-width="1.5" />
        <line x1="30" y1="30" x2="40" y2="50" stroke="#e53e3e" stroke-width="1.5" />
        <circle cx="30" cy="30" r="5" fill="white" stroke="#e53e3e" stroke-width="1.5" />
        <circle cx="20" cy="50" r="4" fill="white" stroke="#e53e3e" stroke-width="1.5" />
        <circle cx="40" cy="50" r="4" fill="white" stroke="#e53e3e" stroke-width="1.5" />
      </g>
      <!-- 第一棵树的贡献线 -->
      <path d="M0,220 L200,220 L200,170 L400,170 L400,190 L740,190" stroke="#e53e3e" stroke-width="3" stroke-dasharray="1180" stroke-dashoffset="1180" fill="none">
        <animate attributeName="stroke-dashoffset" from="1180" to="0" dur="1.5s" begin="4.5s" fill="freeze" />
      </path>
      <!-- 标签 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="6s" fill="freeze" />
        <rect x="580" y="160" width="150" height="25" rx="5" fill="#fff5f5" stroke="#e53e3e" stroke-width="1" />
        <text x="655" y="177" text-anchor="middle" font-size="14" fill="#e53e3e">第一棵树的贡献</text>
      </g>
      <!-- 残差演示 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="6.5s" fill="freeze" />
        <line x1="200" y1="100" x2="200" y2="170" stroke="#319795" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="350" y1="80" x2="350" y2="170" stroke="#319795" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="500" y1="180" x2="500" y2="190" stroke="#319795" stroke-width="1.5" stroke-dasharray="3,2" />
        <!-- 残差标签 -->
        <text x="225" y="135" text-anchor="middle" font-size="12" fill="#319795" transform="rotate(-90, 225, 135)">残差</text>
        <text x="375" y="125" text-anchor="middle" font-size="12" fill="#319795" transform="rotate(-90, 375, 125)">残差</text>
        <text x="525" y="185" text-anchor="middle" font-size="12" fill="#319795" transform="rotate(-90, 525, 185)">残差</text>
      </g>
    </g>
    <!-- 阶段3：第二棵树的贡献 -->
    <g>
      <!-- 微型树图标 -->
      <g opacity="0" transform="translate(120, 30)">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="7s" fill="freeze" />
        <rect x="0" y="0" width="60" height="70" rx="5" fill="#e6fffa" stroke="#319795" stroke-width="1.5" />
        <text x="30" y="20" text-anchor="middle" font-size="12" font-weight="bold" fill="#319795">树 2</text>
        <!-- 简化树图形 -->
        <line x1="15" y1="30" x2="45" y2="30" stroke="#319795" stroke-width="1.5" />
        <line x1="30" y1="30" x2="20" y2="50" stroke="#319795" stroke-width="1.5" />
        <line x1="30" y1="30" x2="40" y2="50" stroke="#319795" stroke-width="1.5" />
        <circle cx="30" cy="30" r="5" fill="white" stroke="#319795" stroke-width="1.5" />
        <circle cx="20" cy="50" r="4" fill="white" stroke="#319795" stroke-width="1.5" />
        <circle cx="40" cy="50" r="4" fill="white" stroke="#319795" stroke-width="1.5" />
      </g>
      <!-- 第二棵树的贡献线 -->
      <path d="M0,170 L200,170 L200,185 L350,185 L350,160 L500,160 L500,190 L740,190" stroke="#319795" stroke-width="3" stroke-dasharray="1190" stroke-dashoffset="1190" fill="none">
        <animate attributeName="stroke-dashoffset" from="1190" to="0" dur="1.5s" begin="7.5s" fill="freeze" />
      </path>
      <!-- 标签 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="9s" fill="freeze" />
        <rect x="580" y="130" width="150" height="25" rx="5" fill="#e6fffa" stroke="#319795" stroke-width="1" />
        <text x="655" y="147" text-anchor="middle" font-size="14" fill="#319795">第二棵树的贡献</text>
      </g>
      <!-- 残差动画 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="9.5s" fill="freeze" />
        <line x1="200" y1="100" x2="200" y2="145" stroke="#4299e1" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="350" y1="80" x2="350" y2="140" stroke="#4299e1" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="500" y1="180" x2="500" y2="160" stroke="#4299e1" stroke-width="1.5" stroke-dasharray="3,2" />
      </g>
    </g>
    <!-- 阶段4：第三棵树的贡献 -->
    <g>
      <!-- 微型树图标 -->
      <g opacity="0" transform="translate(200, 30)">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="10s" fill="freeze" />
        <rect x="0" y="0" width="60" height="70" rx="5" fill="#ebf8ff" stroke="#4299e1" stroke-width="1.5" />
        <text x="30" y="20" text-anchor="middle" font-size="12" font-weight="bold" fill="#4299e1">树 3</text>
        <!-- 简化树图形 -->
        <line x1="15" y1="30" x2="45" y2="30" stroke="#4299e1" stroke-width="1.5" />
        <line x1="30" y1="30" x2="20" y2="50" stroke="#4299e1" stroke-width="1.5" />
        <line x1="30" y1="30" x2="40" y2="50" stroke="#4299e1" stroke-width="1.5" />
        <circle cx="30" cy="30" r="5" fill="white" stroke="#4299e1" stroke-width="1.5" />
        <circle cx="20" cy="50" r="4" fill="white" stroke="#4299e1" stroke-width="1.5" />
        <circle cx="40" cy="50" r="4" fill="white" stroke="#4299e1" stroke-width="1.5" />
      </g>
      <!-- 第三棵树的贡献线 -->
      <path d="M0,140 L100,140 L100,135 L300,135 L300,125 L450,125 L450,145 L600,145 L600,160 L740,160" stroke="#4299e1" stroke-width="3" stroke-dasharray="1240" stroke-dashoffset="1240" fill="none">
        <animate attributeName="stroke-dashoffset" from="1240" to="0" dur="1.5s" begin="10.5s" fill="freeze" />
      </path>
      <!-- 标签 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="12s" fill="freeze" />
        <rect x="580" y="100" width="150" height="25" rx="5" fill="#ebf8ff" stroke="#4299e1" stroke-width="1" />
        <text x="655" y="117" text-anchor="middle" font-size="14" fill="#4299e1">第三棵树的贡献</text>
      </g>
    </g>
    <!-- 最终预测 -->
    <g>
      <!-- 最终曲线 -->
      <path d="M0,220 C100,200 200,150 300,120 C400,100 500,120 600,140 C650,150 700,160 740,170" stroke="#6b46c1" stroke-width="4" fill="none" stroke-dasharray="880" stroke-dashoffset="880">
        <animate attributeName="stroke-dashoffset" from="880" to="0" dur="2s" begin="13s" fill="freeze" />
      </path>
      <!-- 标签 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="15s" fill="freeze" />
        <rect x="580" y="70" width="150" height="25" rx="5" fill="#faf5ff" stroke="#6b46c1" stroke-width="1.5" filter="url(#glow)" />
        <text x="655" y="87" text-anchor="middle" font-size="14" font-weight="bold" fill="#6b46c1">最终预测</text>
      </g>
      <!-- 最终误差线 -->
      <g opacity="0">
        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="15.5s" fill="freeze" />
        <line x1="200" y1="100" x2="200" y2="121" stroke="#6b46c1" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="350" y1="80" x2="350" y2="117" stroke="#6b46c1" stroke-width="1.5" stroke-dasharray="3,2" />
        <line x1="500" y1="180" x2="500" y2="151" stroke="#6b46c1" stroke-width="1.5" stroke-dasharray="3,2" />
        <!-- 最终误差极小标签 -->
        <text x="275" y="105" text-anchor="middle" font-size="12" fill="#6b46c1">误差显著减小!</text>
      </g>
    </g>
  </g>
  <!-- 图例说明区域 -->
  <g transform="translate(450, 430)">
    <rect x="-370" y="-20" width="740" height="70" rx="8" fill="#f7fafc" stroke="#e2e8f0" stroke-width="1.5" filter="url(#dropShadow)" />
    <g transform="translate(-310, 0)">
      <circle cx="0" cy="0" r="8" fill="#2d3748" />
      <text x="15" y="5" font-size="14" fill="#2d3748">数据点</text>
    </g>
    <g transform="translate(-200, 0)">
      <line x1="-15" y1="0" x2="15" y2="0" stroke="#718096" stroke-width="3" />
      <text x="30" y="5" font-size="14" fill="#718096">初始预测</text>
    </g>
    <g transform="translate(-65, 0)">
      <line x1="-15" y1="0" x2="15" y2="0" stroke="#e53e3e" stroke-width="3" />
      <text x="30" y="5" font-size="14" fill="#e53e3e">树1贡献</text>
    </g>
    <g transform="translate(65, 0)">
      <line x1="-15" y1="0" x2="15" y2="0" stroke="#319795" stroke-width="3" />
      <text x="30" y="5" font-size="14" fill="#319795">树2贡献</text>
    </g>
    <g transform="translate(195, 0)">
      <line x1="-15" y1="0" x2="15" y2="0" stroke="#4299e1" stroke-width="3" />
      <text x="30" y="5" font-size="14" fill="#4299e1">树3贡献</text>
    </g>
    <g transform="translate(320, 0)">
      <line x1="-15" y1="0" x2="15" y2="0" stroke="#6b46c1" stroke-width="4" />
      <text x="30" y="5" font-size="14" font-weight="bold" fill="#6b46c1">最终预测</text>
    </g>
    <g transform="translate(0, 30)">
      <text x="0" y="0" text-anchor="middle" font-size="14" font-weight="bold" fill="#4a5568">XGBoost核心原理：每棵新树专注于修正前面树的残差，最终结果是所有树贡献的总和</text>
    </g>
  </g>
</svg>
<p>假设我们有一个简单的回归问题，以下是XGBoost预测的演进过程：</p>
<ol>
<li><strong>初始预测</strong>：0.5（全局平均值）</li>
<li><strong>第一棵树</strong>：通过拟合残差，将预测调整为更接近真实值</li>
<li><strong>第二棵树</strong>：继续纠正剩余误差</li>
<li><strong>最终模型</strong>：多棵树的预测相加，形成精确预测</li>
</ol>
<p>通过这一过程，我们可以看到XGBoost如何逐步改进预测，每棵树都专注于解决前面模型的不足。</p>
<h3 id="53-用xgboost解决现实问题"><a class="markdownIt-Anchor" href="#53-用xgboost解决现实问题"></a> 5.3 用XGBoost解决现实问题</h3>
<p>以信用违约预测为例，XGBoost的应用流程：</p>
<ol>
<li>
<p><strong>数据预处理</strong>：</p>
<ul>
<li>处理缺失值（XGBoost本身可以处理）</li>
<li>对分类变量进行编码</li>
<li>特征工程（创建交互特征等）</li>
</ul>
</li>
<li>
<p><strong>特征选择</strong>：</p>
<ul>
<li>使用XGBoost的<code>feature_importance</code>评估特征</li>
<li>移除低重要性特征，减少噪声</li>
</ul>
</li>
<li>
<p><strong>交叉验证与调参</strong>：</p>
<ul>
<li>使用5折交叉验证评估模型</li>
<li>网格搜索或贝叶斯优化寻找最佳参数</li>
</ul>
</li>
<li>
<p><strong>解释模型</strong>：</p>
<ul>
<li>分析特征重要性</li>
<li>使用SHAP值解释单个预测</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV<br><br><span class="hljs-comment"># 参数网格</span><br>param_grid = &#123;<br>    <span class="hljs-string">&#x27;max_depth&#x27;</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>],<br>    <span class="hljs-string">&#x27;min_child_weight&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],<br>    <span class="hljs-string">&#x27;gamma&#x27;</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>],<br>    <span class="hljs-string">&#x27;subsample&#x27;</span>: [<span class="hljs-number">0.8</span>, <span class="hljs-number">0.9</span>],<br>    <span class="hljs-string">&#x27;colsample_bytree&#x27;</span>: [<span class="hljs-number">0.8</span>, <span class="hljs-number">0.9</span>],<br>    <span class="hljs-string">&#x27;learning_rate&#x27;</span>: [<span class="hljs-number">0.01</span>, <span class="hljs-number">0.05</span>, <span class="hljs-number">0.1</span>]<br>&#125;<br><br><span class="hljs-comment"># 创建XGBoost模型</span><br>xgb_model = xgb.XGBClassifier(objective=<span class="hljs-string">&#x27;binary:logistic&#x27;</span>, seed=<span class="hljs-number">42</span>)<br><br><span class="hljs-comment"># 网格搜索</span><br>grid_search = GridSearchCV(<br>    estimator=xgb_model,<br>    param_grid=param_grid,<br>    scoring=<span class="hljs-string">&#x27;roc_auc&#x27;</span>,<br>    cv=<span class="hljs-number">5</span>,<br>    verbose=<span class="hljs-number">1</span><br>)<br><br><span class="hljs-comment"># 训练</span><br>grid_search.fit(X_train, y_train)<br><br><span class="hljs-comment"># 最佳参数</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Best parameters:&quot;</span>, grid_search.best_params_)<br></code></pre></td></tr></table></figure>
<h2 id="6-xgboost的未来发展与挑战"><a class="markdownIt-Anchor" href="#6-xgboost的未来发展与挑战"></a> 6. XGBoost的未来发展与挑战</h2>
<p>尽管XGBoost已经非常成功，但它仍面临一些挑战和发展方向：</p>
<h3 id="61-xgboost的局限性"><a class="markdownIt-Anchor" href="#61-xgboost的局限性"></a> 6.1 XGBoost的局限性</h3>
<ol>
<li><strong>黑盒性质</strong>：尽管比深度学习模型可解释性更强，但与线性模型相比仍难以解释</li>
<li><strong>大规模离散特征处理</strong>：对于高维稀疏特征，表现可能不如某些专用算法</li>
<li><strong>超参数敏感性</strong>：需要谨慎调参，否则可能性能不佳</li>
</ol>
<h3 id="62-前沿研究与改进方向"><a class="markdownIt-Anchor" href="#62-前沿研究与改进方向"></a> 6.2 前沿研究与改进方向</h3>
<ol>
<li>
<p><strong>XGBoost与深度学习结合</strong>：</p>
<ul>
<li>将树模型作为深度网络的一部分</li>
<li>使用神经网络生成特征，再用XGBoost分类</li>
</ul>
</li>
<li>
<p><strong>分布式与联邦学习</strong>：</p>
<ul>
<li>进一步优化分布式训练</li>
<li>支持隐私保护的联邦学习环境</li>
</ul>
</li>
<li>
<p><strong>可解释性研究</strong>：</p>
<ul>
<li>开发更好的可视化和解释工具</li>
<li>整合因果推断方法</li>
</ul>
</li>
</ol>
<h2 id="7-总结与思考"><a class="markdownIt-Anchor" href="#7-总结与思考"></a> 7. 总结与思考</h2>
<p>XGBoost的本质是一个精心设计的梯度提升框架，它通过以下核心元素取得成功：</p>
<ol>
<li><strong>数学上的精确</strong>：使用二阶导数捕捉更丰富的信息</li>
<li><strong>算法上的创新</strong>：正则化、缺失值处理、近似算法等</li>
<li><strong>工程上的优化</strong>：并行化、缓存优化、分布式计算支持</li>
</ol>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 400">
  <!-- 背景 -->
  <rect width="700" height="400" fill="white"/>
  <!-- 标题 -->
  <text x="350" y="40" text-anchor="middle" font-size="20" font-weight="bold">XGBoost的本质</text>
  <!-- 中心概念圆 -->
  <circle cx="350" cy="200" r="100" fill="#e6f7ff" stroke="#0066cc" stroke-width="2.5"/>
  <text x="350" y="180" text-anchor="middle" font-size="18" font-weight="bold" fill="#0066cc">XGBoost</text>
  <text x="350" y="210" text-anchor="middle" font-size="10">高效梯度提升框架</text>
  <text x="350" y="230" text-anchor="middle" font-size="10">精确 · 高效 · 可扩展</text>
  <!-- 四个关键组成部分 -->
  <!-- 1. 决策树 -->
  <g transform="translate(150, 100)">
    <circle cx="0" cy="0" r="60" fill="#f2f2f2" stroke="#333" stroke-width="2"/>
    <text x="0" y="-15" text-anchor="middle" font-size="16" font-weight="bold">决策树</text>
    <text x="0" y="10" text-anchor="middle" font-size="12">基础预测单元</text>
    <text x="0" y="30" text-anchor="middle" font-size="12">递归二分划分</text>
  </g>
  <!-- 2. 梯度提升 -->
  <g transform="translate(550, 100)">
    <circle cx="0" cy="0" r="60" fill="#fff2e6" stroke="#ff6600" stroke-width="2"/>
    <text x="0" y="-15" text-anchor="middle" font-size="16" font-weight="bold">梯度提升</text>
    <text x="0" y="10" text-anchor="middle" font-size="12">序列集成策略</text>
    <text x="0" y="30" text-anchor="middle" font-size="12">逐步拟合残差</text>
  </g>
  <!-- 3. 正则化 -->
  <g transform="translate(150, 300)">
    <circle cx="0" cy="0" r="60" fill="#e6ffe6" stroke="#009900" stroke-width="2"/>
    <text x="0" y="-15" text-anchor="middle" font-size="16" font-weight="bold">正则化</text>
    <text x="0" y="10" text-anchor="middle" font-size="12">控制模型复杂度</text>
    <text x="0" y="30" text-anchor="middle" font-size="12">防止过拟合</text>
  </g>
  <!-- 4. 系统优化 -->
  <g transform="translate(550, 300)">
    <circle cx="0" cy="0" r="60" fill="#ffe6ff" stroke="#990099" stroke-width="2"/>
    <text x="0" y="-15" text-anchor="middle" font-size="16" font-weight="bold">系统优化</text>
    <text x="0" y="10" text-anchor="middle" font-size="12">并行计算</text>
    <text x="0" y="30" text-anchor="middle" font-size="12">高效内存利用</text>
  </g>
  <!-- 连接线 -->
  <line x1="200" y1="140" x2="295" y2="180" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="500" y1="140" x2="405" y2="180" stroke="#ff6600" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="200" y1="260" x2="295" y2="220" stroke="#009900" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="500" y1="260" x2="405" y2="220" stroke="#990099" stroke-width="1.5" marker-end="url(#arrow)"/>
  <!-- 底部总结 -->
  <rect x="100" y="370" width="500" height="30" rx="15" fill="#f5f5f5" stroke="#333" stroke-width="1"/>
  <text x="350" y="390" text-anchor="middle" font-size="16" font-weight="bold">集成学习 + 最优化 + 工程实现的完美结合</text>
  <!-- 箭头定义 -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
</svg>
<blockquote>
<p>XGBoost = 决策树 + 梯度提升 + 正则化 + 系统优化</p>
<p>或者更简洁地：XGBoost = 集成学习的艺术与工程的完美结合</p>
</blockquote>
<p>它的成功不仅在于算法本身，还在于平衡了<strong>精度</strong>、<strong>速度</strong>和<strong>可用性</strong>的权衡，使其成为理论与实践的完美结合。对于数据科学从业者，理解XGBoost的原理不仅有助于更好地使用这一工具，也能启发我们思考机器学习算法设计的哲学。</p>
<h2 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h2>
<ol>
<li>Chen, T., &amp; Guestrin, C. (2016). XGBoost: A Scalable Tree Boosting System. <em>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>.</li>
<li>Friedman, J. H. (2001). Greedy function approximation: A gradient boosting machine. <em>Annals of Statistics</em>.</li>
<li>《机器学习》，周志华著，清华大学出版社</li>
<li>XGBoost官方文档：<a target="_blank" rel="noopener" href="https://xgboost.readthedocs.io/">https://xgboost.readthedocs.io/</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E7%AE%97%E6%B3%95/" class="category-chain-item">算法</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/XGBoost/" class="print-no-link">#XGBoost</a>
      
        <a href="/tags/%E5%86%B3%E7%AD%96%E6%A0%91/" class="print-no-link">#决策树</a>
      
        <a href="/tags/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/" class="print-no-link">#集成学习</a>
      
        <a href="/tags/%E6%A2%AF%E5%BA%A6%E6%8F%90%E5%8D%87/" class="print-no-link">#梯度提升</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>XGBoost</div>
      <div>http://xcq.ink/2022/12/19/XGBoost/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Xander Xu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年12月19日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/01/23/%E4%BA%BA%E4%B8%8EAI%E7%9A%84%E5%85%B3%E7%B3%BB/" title="人与AI的关系:我们如何证明自己不是机器？">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">人与AI的关系:我们如何证明自己不是机器？</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/25/ResNet%E6%80%9D%E8%80%83%E5%92%8C%E7%90%86%E8%A7%A3%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E6%99%BA%E6%85%A7%E6%8D%B7%E5%BE%84/" title="ResNet思考和理解：深度学习中的智慧捷径">
                        <span class="hidden-mobile">ResNet思考和理解：深度学习中的智慧捷径</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
